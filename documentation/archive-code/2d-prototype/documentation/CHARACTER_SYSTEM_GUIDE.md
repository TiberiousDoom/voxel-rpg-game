# Character System User Guide

## Overview

The RPG Character System provides deep progression mechanics with attributes, skills, and active abilities that meaningfully impact gameplay.

## Table of Contents
- [Getting Started](#getting-started)
- [Attributes](#attributes)
- [Skill Trees](#skill-trees)
- [Active Skills](#active-skills)
- [Progression & Leveling](#progression--leveling)
- [Strategy Tips](#strategy-tips)

---

## Getting Started

### Opening the Character Sheet

- **Press `C` key** to open/close the Character Sheet
- **Press `ESC`** to close any open UI panels

### Character Sheet Tabs

1. **Attributes** - Allocate attribute points to increase character power
2. **Skills** - Navigate the Settlement skill tree and allocate skill points
3. **Derived Stats** - View calculated stats from attributes and equipment

---

## Attributes

### Overview

Attributes are permanent character stats that affect all aspects of gameplay. You gain **5 attribute points per level**.

### The 6 Attributes

#### üéñÔ∏è Leadership
- **Primary Effect**: NPC efficiency and capacity
- **Bonuses**:
  - +1% NPC work efficiency per point
  - +1 max NPC capacity per 10 points
  - +0.5 NPC happiness per point
- **Best For**: Settlement builders, NPC managers

#### üèóÔ∏è Construction
- **Primary Effect**: Building speed and costs
- **Bonuses**:
  - -1% building cost per point (capped at 30%)
  - +2% building speed per point
  - Better building quality
- **Best For**: Base builders, rapid expansion

#### üß≠ Exploration
- **Primary Effect**: Movement and resource gathering
- **Bonuses**:
  - +1% movement speed per point
  - +2% gathering speed per point
  - +1% rare resource find chance per point
- **Best For**: Explorers, resource gatherers

#### ‚öîÔ∏è Combat
- **Primary Effect**: Physical damage and defense
- **Bonuses**:
  - +1.5 physical damage per point
  - +0.5 defense per point
  - +0.2% crit chance per point
  - +1% attack speed per point
- **Best For**: Warriors, combat-focused players

#### ‚ú® Magic
- **Primary Effect**: Spell power and mana
- **Bonuses**:
  - +8 max mana per point
  - +0.5 mana regen per point
  - +2% spell damage per point
  - -0.5% spell cooldown per point (capped at 40%)
  - -0.5% mana cost per point (capped at 40%)
- **Best For**: Mages, spell casters

#### üí™ Endurance
- **Primary Effect**: Health and stamina
- **Bonuses**:
  - +15 max health per point
  - +5 max stamina per point
  - +0.3 health regen per point
  - +0.5% damage resistance per point
- **Best For**: Tanks, survivability

### Soft Caps

**All attributes have diminishing returns:**
- **0-50 points**: 100% effectiveness
- **51-100 points**: 75% effectiveness
- **101+ points**: 50% effectiveness

**Strategy**: Diversify your build or accept reduced efficiency after 50 points.

---

## Skill Trees

### Settlement Skill Tree

30 skills across 5 tiers provide powerful passive bonuses and active abilities.

### Tier Requirements

| Tier | Level Required | Points in Tree | Skill Types |
|------|----------------|----------------|-------------|
| 1 | Level 1 | 0 | 5 passive |
| 2 | Level 5 | 5 | 5 passive, 2 active |
| 3 | Level 10 | 10 | 5 passive, 2 active |
| 4 | Level 15 | 15 | 5 passive, 2 active |
| 5 | Level 20 | 20 | 2 capstone (mutually exclusive) |

### Tier 1: Foundation (Level 1)

**Passive Skills:**
- **Efficient Builder** - +10% building placement speed
- **Resource Management** - +10% storage capacity
- **Inspiring Leader** - +5% NPC efficiency
- **Careful Planning** - -10% building costs
- **Quick Learner** - +10% XP gain

### Tier 2: Specialization (Level 5)

**Passive Skills:**
- **Master Builder** - +25% building speed
- **Prospector** - +15% rare resource find chance
- **Natural Leader** - +10% NPC efficiency
- **Economic Genius** - +15% gold gain
- **Scholar** - +15% XP gain

**Active Skills:**
- **Rally Cry** (60s duration, 300s cooldown)
  - +20% NPC efficiency for all NPCs
  - Use when production is critical

- **Instant Repair** (Instant, 600s cooldown)
  - Repair all buildings to full health
  - Great for defense or after raids

### Tier 3: Mastery (Level 10)

**Passive Skills:**
- **Architectural Genius** - +50% building quality, -15% costs
- **Resource Empire** - +50% resource production
- **Charismatic** - +15% NPC recruitment chance
- **Trade Master** - +25% gold from sales
- **Lore Master** - +20% XP from quests

**Active Skills:**
- **Mass Production** (30s duration, 300s cooldown)
  - +100% production from all buildings
  - Stack with other bonuses for massive output

- **Kingdom's Blessing** (120s duration, 600s cooldown)
  - +10% to all stats
  - Universal buff for any situation

### Tier 4: Legendary (Level 15)

**Passive Skills:**
- **Master of All Trades** - +100% building speed
- **Abundant Harvest** - +100% resource gathering
- **Legendary Leader** - +25% NPC efficiency, +5 capacity
- **Economic Powerhouse** - +50% gold gain
- **Sage** - +30% XP gain

**Active Skills:**
- **Instant Fortress** (60s duration, 900s cooldown)
  - 5x construction speed
  - Build entire bases rapidly

- **Golden Age** (120s duration, 1200s cooldown)
  - +50% gold gain, +50% resource production
  - Perfect for economic booms

### Tier 5: Capstone (Level 20)

**Choose ONE:**

- **Civilization** (Passive)
  - +100% resource production
  - +50% XP gain
  - +10 max NPC capacity
  - **Best For**: Long-term empire building

- **Empire Builder** (Passive)
  - +200% building efficiency
  - -50% building costs
  - +100% building speed
  - **Best For**: Rapid expansion, base building

**‚ö†Ô∏è Important**: You can only allocate ONE capstone skill. Choose wisely!

### Skill Point Allocation

- Gain **2 skill points per level**
- Click skills to allocate points
- Click `-` button to deallocate (respec)
- Use "Reset Tree" button to refund all points (useful for trying new builds)

---

## Active Skills

### Activation

**Three ways to activate:**
1. **Hotkeys**: Press `1`, `2`, `3`, `4`, `5`, or `6` keys
2. **Mouse**: Click skill buttons in the skill bar (bottom of screen)
3. **Skill Tree**: Click activate button in skill details panel

### Skill Bar (Bottom HUD)

- Shows all unlocked active skills
- Displays cooldowns with visual overlay
- Shows active buffs with duration timers
- Hotkey badges (1-6) for quick reference

### Cooldown System

- Each skill has a cooldown period after activation
- Cooldowns shown in seconds on skill button
- Visual fill shows cooldown progress
- Cannot activate skills on cooldown

### Buff Duration

- Active skills with duration create temporary buffs
- Buffs shown above skill bar with remaining time
- Buffs stack with passive bonuses
- Multiple buffs can be active simultaneously

### Strategic Usage

**Rally Cry** (Tier 2):
- Use before major production cycles
- Activate„Åì„Çå„ÅØ when you have many NPCs assigned
- 60s duration = 12 production ticks (at 5s/tick)

**Mass Production** (Tier 3):
- Best during resource shortages
- Combine with production buildings
- 30s duration = 6 production ticks

**Instant Fortress** (Tier 4):
- Use when you need multiple buildings fast
- Great for new settlements
- 60s of 5x speed = effectively 5 minutes of building

**Golden Age** (Tier 4):
- Economic emergency button
- Use for resource/gold boosts
- 120s duration = 24 production ticks

---

## Progression & Leveling

### XP Sources

- Killing monsters
- Completing quests
- Building structures
- Resource gathering
- NPC tasks

### XP Bonuses

**From Skills:**
- Quick Learner (Tier 1): +10%
- Scholar (Tier 2): +15%
- Lore Master (Tier 3): +20%
- Sage (Tier 4): +30%
- Civilization (Tier 5): +50%

**These stack!** All 5 skills = +125% XP gain (2.25x XP)

### Leveling Rewards

**Every Level:**
- 5 Attribute Points
- 2 Skill Points
- Full health/mana/stamina restore
- Stats recalculated with new bonuses

**Level Milestones:**
- Level 5: Unlock Tier 2 skills
- Level 10: Unlock Tier 3 skills
- Level 15: Unlock Tier 4 skills
- Level 20: Unlock Tier 5 capstones

---

## Strategy Tips

### Early Game (Levels 1-5)

**Recommended Build:**
- Attributes: Split between Leadership + Construction
- Skills: Quick Learner, Efficient Builder, Resource Management

**Focus**: Establish base, get production running, level up quickly with XP bonus.

### Mid Game (Levels 6-15)

**Recommended Build:**
- Attributes: Continue Leadership/Construction, add Combat
- Skills: Unlock Rally Cry, Scholar, Natural Leader

**Focus**: Expand base, increase NPC efficiency, manage resources.

### Late Game (Level 16+)

**Specialized Builds:**

**Builder Specialist:**
- Attributes: Construction (50+), Leadership (40+)
- Skills: Path to Empire Builder capstone
- Playstyle: Rapid expansion, mega bases

**Production Specialist:**
- Attributes: Leadership (50+), Exploration (30+)
- Skills: Path to Civilization capstone
- Playstyle: Resource empire, NPC management

**Combat Specialist:**
- Attributes: Combat (50+), Endurance (40+)
- Skills: Mix of XP bonuses for fast leveling
- Playstyle: Monster hunting, expeditions

### Min-Max Tips

**XP Stacking:**
- Quick Learner + Scholar + Lore Master = +45% XP
- Add Sage at level 15 = +75% XP total
- Fastest leveling strategy

**Production Stacking:**
- Inspiring Leader + Natural Leader + Legendary Leader = +40% NPC efficiency (passive)
- Activate Rally Cry = +60% total
- Combine with Mass Production = +160% production

**Economy Stacking:**
- Economic Genius + Trade Master + Economic Powerhouse = +90% gold (passive)
- Activate Golden Age = +140% gold total
- Combine with high-value trades

### Respec Strategy

**When to Respec:**
- Changed playstyle (builder ‚Üí combat)
- Reached new tier, want to optimize
- Made mistakes in allocation
- Trying new build

**How to Respec:**
1. Open Character Sheet
2. Go to Skills tab
3. Click "Reset Tree" button
4. Reallocate points

**Cost**: Currently free! Take advantage to experiment.

---

## FAQ

### Q: Can I reset my attributes?
**A:** Currently no attribute respec system. Plan carefully!

### Q: How many skill points will I have at max level?
**A:** Level 25 = 2 √ó 24 = 48 skill points (level 1 gives no points)

### Q: Can I max all skills?
**A:** No. With 48 points and 30 skills, you must specialize.

### Q: Do active skill buffs stack?
**A:** Yes! Multiple active skills can buff different stats simultaneously.

### Q: What happens if I take both capstones?
**A:** You can't. They are mutually exclusive. Choose one path.

### Q: Do passive bonuses apply immediately?
**A:** Yes! As soon as you allocate a passive skill, bonuses apply.

### Q: Can I see all my total bonuses?
**A:** Yes! Check the "Derived Stats" tab to see all calculated values.

### Q: What's the best build?
**A:** Depends on playstyle:
  - Builder: Construction + Empire Builder
  - Economy: Leadership + Civilization
  - Combat: Combat + Endurance
  - Hybrid: Balanced attributes

---

## Technical Details

### Bonus Calculations

**Passive bonuses** are always active and calculated in `calculateDerivedStats()`.

**Active buffs** add to passive bonuses during their duration.

**Formula**: `Final Bonus = (Attribute Bonus) √ó (1 + Passive Skills) √ó (1 + Active Buffs)`

### Integration Points

**XP System** (`useGameStore.addXP`):
- Applies `xpGainMultiplier` from skills
- Quick Learner, Scholar, Lore Master, Sage, Civilization

**Gold System** (`useGameStore.addGold`):
- Applies `goldGain` bonus from skills
- Economic Genius, Trade Master, Economic Powerhouse

**Production System** (`ProductionTick._calculateBuildingProduction`):
- Applies `resourceProduction` and `buildingEfficiency` bonuses
- Resource Management, Resource Empire, Empire Builder

**NPC System** (via `skillEffects.npcEfficiency`):
- Inspiring Leader, Natural Leader, Legendary Leader, Rally Cry

### Save/Load

- Character data (attributes, skills) saved automatically
- Active skill cooldowns/buffs serialized in save files
- Reloading game restores progression exactly

---

## Changelog

**Version 1.0** (Phase 1-3 Complete):
- ‚úÖ 6 attributes with soft caps
- ‚úÖ 30 settlement skills across 5 tiers
- ‚úÖ 6 active skills with cooldowns
- ‚úÖ Character sheet UI
- ‚úÖ Full game integration (XP, gold, production)
- ‚úÖ Active skill bar HUD
- ‚úÖ Save/load support

**Future Updates** (Post-MVP):
- Explorer Skill Tree (planned)
- Combat Skill Tree (planned)
- Attribute respec system
- Equipment bonuses
- Character customization

---

## Credits

Character System designed and implemented for Voxel RPG Game.

For technical documentation, see `RPG_CHARACTER_SYSTEM_PLAN.md` in the planning folder.
